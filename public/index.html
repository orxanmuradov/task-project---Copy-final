 <!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Qeydiyyat - TapÅŸÄ±rÄ±qlar</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* GiriÅŸ/Qeydiyyat Ã¼Ã§Ã¼n xÃ¼susi mÉ™rkÉ™zlÉ™ÅŸdirmÉ™ */
        body { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .login-container { background: #1e1e1e; padding: 2rem; border-radius: 12px; border: 1px solid #333; width: 100%; max-width: 400px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { color: #ffcc00; margin-bottom: 20px; }
        .link { margin-top: 15px; display: block; color: #888; text-decoration: none; font-size: 0.9rem; transition: 0.3s; }
        .link:hover { color: #ffcc00; }
        
        /* Modal BaÅŸlÄ±q RÉ™nglÉ™ri */
        .modal-success h3 { color: #00e676 !important; } /* UÄŸurlu - YaÅŸÄ±l */
        .modal-error h3 { color: #ff4d4d !important; }   /* XÉ™ta - QÄ±rmÄ±zÄ± */
    </style>
</head>
<body>

    <div class="login-container">
        <h2>Qeydiyyat</h2>
        <form id="register-form">
            <div class="form-row" style="flex-direction: column;">
                <input type="text" id="username" placeholder="Ä°stifadÉ™Ã§i adÄ± seÃ§in" required autocomplete="off">
                <input type="password" id="password" placeholder="ÅifrÉ™ tÉ™yin edin" required>
            </div>
            <button type="submit" class="add-btn" style="margin-top: 20px;">Qeydiyyatdan KeÃ§</button>
        </form>
        <a href="login.html" class="link">ArtÄ±q hesabÄ±n var? Daxil ol</a>
    </div>

    <div id="status-modal" class="modal-overlay">
        <div class="modal-box">
            <h3 id="modal-title">BildiriÅŸ</h3>
            <p id="modal-message" style="margin: 15px 0; color: #ccc; font-size: 1rem;"></p>
            
            <div class="modal-buttons">
                <button id="modal-ok-btn" class="modal-btn save">BaÅŸa dÃ¼ÅŸdÃ¼m</button>
            </div>
        </div>
    </div>

    <script>
        // Modal ElementlÉ™ri
        const modal = document.getElementById("status-modal");
        const modalBox = document.querySelector(".modal-box");
        const modalTitle = document.getElementById("modal-title");
        const modalMessage = document.getElementById("modal-message");
        const modalBtn = document.getElementById("modal-ok-btn");
        
        let redirectAfterClose = false; // "Tamam" basanda yÃ¶nlÉ™ndirsin?

        // ModalÄ± AÃ§aq Funksiya
        function showModal(title, message, isSuccess) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            
            // RÉ™nglÉ™ri tÉ™nzimlÉ™yÉ™k
            if (isSuccess) {
                modalBox.classList.remove("modal-error");
                modalBox.classList.add("modal-success");
                redirectAfterClose = true;
            } else {
                modalBox.classList.remove("modal-success");
                modalBox.classList.add("modal-error");
                redirectAfterClose = false;
            }

            modal.style.display = "flex";
        }

        // Modal dÃ¼ymÉ™sinÉ™ basanda
        modalBtn.addEventListener("click", () => {
            modal.style.display = "none";
            if (redirectAfterClose) {
                window.location.href = "login.html";
            }
        });

        // Qeydiyyat MÉ™ntiqi
        document.getElementById("register-form").addEventListener("submit", async (e) => {
            e.preventDefault();
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            try {
                const res = await fetch("/api/users/register", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ username, password })
                });

                const data = await res.json();

                if (res.ok) {
                    showModal("TÉ™briklÉ™r! ğŸ‰", "Qeydiyyat uÄŸurla tamamlandÄ±. Ä°ndi giriÅŸ edÉ™ bilÉ™rsiniz.", true);
                } else {
                    showModal("XÉ™ta!", data.error || "Qeydiyyat alÄ±nmadÄ±.", false);
                }
            } catch (err) {
                showModal("Server XÉ™tasÄ±", "ServerlÉ™ É™laqÉ™ kÉ™sildi. Ä°nterneti yoxlayÄ±n.", false);
                console.error(err);
            }
        });
    </script>
</body>
</html>